Bootstrap: library
From: ubuntu:16.04

%setup
	# Directory will installation scripts and other files will be stored
	mkdir ${SINGULARITY_ROOTFS}/singularity-build

%files
	# Copy files from the host machine
	/home/hope-singularity/definition-files/python3/packages/base.txt /singularity-build/base.txt
	/home/hope-singularity/definition-files/python3/scripts/install-packages.sh /singularity-build/install-packages.sh
	/home/hope-singularity/definition-files/python3/scripts/install-python.sh /singularity-build/install-python.sh


%post
	WORKDIR=/singularity-build
	PY2VER=2.7.16
	PY3VER=3.7.3

	# Install basic packages
	apt-get update && apt-get -y upgrade
	apt-get install -y build-essential software-properties-common \
		curl htop man unzip wget gcc \
		python3-setuptools
	
	cd /singularity-build

	# Run Python installation script
	bash install-python.sh $PY2VER $PY3VER $WORKDIR

	# Run Python package installation script
	bash install-packages.sh base.txt

%runscript
	python3	$@ # Default to Python 3 and accept arguments
