Bootstrap: library
From: ubuntu:16.04

%post
	# Install required packages
	apt-get update && apt-get -y upgrade
	apt-get install -y build-essential software-properties-common \
		curl git htop man unzip vim wget nano gcc \
		python3-setuptools
	apt-get install -y libreadline-gplv2-dev libncursesw5-dev libssl-dev \
		libsqlite3-dev tk-dev libgdbm-dev libc6-dev libbz2-dev
	apt-get install -y zlib1g-dev libffi-dev 

	#===== Install Python 3 =====#

	VERSION=3.7.3

	wget https://www.python.org/ftp/python/$VERSION/Python-$VERSION.tgz
	gunzip Python-$VERSION.tgz && tar -xvf Python-$VERSION.tar
	cd Python-$VERSION
	./configure -prefix=/usr/local
	make
	make install
	ln -sfn /usr/local/bin/python3.7 /usr/bin/python3
	
	#===== Install Python 2 =====#

	VERSION=2.7.16

    wget https://www.python.org/ftp/python/$VERSION/Python-$VERSION.tgz
    gunzip Python-$VERSION.tgz && tar -xvf Python-$VERSION.tar
    cd Python-$VERSION
    ./configure -prefix=/usr/local
    make
    make install
    ln -sfn /usr/local/bin/python2.7 /usr/bin/python2.7

	#===== Install packages =====#
	sed -i '1d' /usr/bin/lsb_release
    sed -i '1i#!/usr/bin/python\n' /usr/bin/lsb_release
	pip3 install --upgrade pip	

	wget https://raw.githubusercontent.com/hopehpc/singularity/master/build/scripts/scientific.sh
	bash scientific.sh

%runscript
	python3
