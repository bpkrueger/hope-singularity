Bootstrap: library
From: ubuntu:16.04

%post
	WORKINGDIR=/	# Full path to directory where Python and Singularity repo should be installed in container
	PIPSCRIPT=https://raw.githubusercontent.com/hopehpc/singularity/master/build/scripts/python-ml.sh
	PIPNAME=python-ml.sh	# Filename of the script
	PY2VER=2.7.16			# Python 2 version
	PY3VER=3.7.3			# Python 3 version
	
	PACKAGES=(matplotlib numpy pandas tensorflow scikit-learn)

	apt-get update && apt-get -y upgrade

	# Install basic packages
	apt-get install -y build-essential software-properties-common \
    curl git htop man unzip vim wget nano gcc python3-setuptools
	
	# Get Singularity directory
	git clone --bare https://github.com/hopehpc/singularity.git	
	cd $WORKDIR/singularity/build/python3/scripts

	# Run install-python.sh


	# Run install-packages.sh


	# Install CUDA Toolkit
	wget https://developer.nvidia.com/compute/cuda/10.1/Prod/local_installers/cuda-repo-ubuntu1604-10-1-local-10.1.168-418.67_1.0-1_amd64.deb
	dpkg -i cuda-repo-ubuntu1604-10-1-local-10.1.168-418.67_1.0-1_amd64.deb
	apt-key add /var/cuda-repo-<version>/7fa2af80.pub
	apt-get update -y
	apt-get install -y cuda

%runscript
	python3	# Default to Python 3 
